import numpy as np
import matplotlib.pyplot as plt
import matplotlib as mpl
from matplotlib import cm
#import Heisenberg3D_lambda as hl

#mpl.rcParams['figure.dpi'] = 72
plt.rcParams['font.size'] = 20
plt.rcParams['axes.linewidth'] = 1.5

#fisher data
x_axis = 1/np.linspace(.01,5,500)
def fisher(x):
	return 1-(x**2/(np.sinh(x)**2))
def fisheren(x):
	return np.log(np.sinh(x)/x)
y_dif = (fisheren(x_axis+1e-6)-fisheren(x_axis))/(1e-6)
y_axis = fisher(x_axis)
fisher_S = fisheren(x_axis)-(x_axis*y_dif)
#1d data
j1ds = 1/np.linspace(.01,1,50)
j1d = 1/np.linspace(.1,20,400)
f1s = np.array([94.70168263345197, 28.915182717213554, 16.157307352131244, 10.8181508213812, 7.919172572291002, 6.116164508366108, 4.896535590586116, 4.022983326725722, 3.370842446808161, 2.868478502293476, 2.4718693634068867, 2.15250759933964, 1.8911405512241275, 1.6743100582890713, 1.4923343751929583, 1.3380775364588984, 1.2061700103167698, 1.0924988356745815, 0.9938644820743201, 0.9077441023968611, 0.8321245631781937, 0.7653823679628131, 0.7061957902442741, 0.6534795691498391, 0.6063356927708812, 0.564015837473768, 0.5258923757501317, 0.4914357664972658, 0.4601967567012781, 0.4317922500894025, 0.40589399863628045, 0.3822194871643313, 0.3605245362362826, 0.3405972618826513, 0.32225311452063554, 0.3053307820253569, 0.28968878911603957, 0.27520266111872227, 0.26176254769170787, 0.24927122336362484, 0.2376423982772189, 0.22679928548811742, 0.21667338137785536, 0.20720342383369378, 0.1983344992985038, 0.19001727496252088, 0.18220733653047144, 0.17486461536432343, 0.16795289153776982, 0.1614393615711969])
f1sp = np.array([94.70267263350196, 28.916152513588056, 16.158256945238428, 10.819080211629228, 7.920081760088569, 6.117053494150239, 4.897404375185776, 4.023831913288151, 3.3716708462545166, 2.869286743230199, 2.472657505134903, 2.153275745074012, 1.8918888587098364, 1.6750387461151335, 1.493043724398867, 1.3387678879776417, 1.206841759283684, 1.0931524237410295, 0.994500388747096, 0.9083628362049602, 0.8327266532314272, 0.7659683562560985, 0.7067662248945936, 0.6540349986316073, 0.6068766611339551, 0.5645428804782069, 0.5264060178247407, 0.4919365184178793, 0.4606851138840157, 0.43226869139974644, 0.4063589856238308, 0.38267346364362687, 0.36096792814483863, 0.34103047735769876, 0.322676544145474, 0.3057447992046332, 0.29009375054655917, 0.2755989073286464, 0.26215040362626085, 0.2496509989998567, 0.2380143892540083, 0.2271637737406231, 0.2170306357680743, 0.20755370077078836, 0.19867804334416878, 0.1903543194179616, 0.18253810400260342, 0.17518931830960957, 0.1682717327827748, 0.1617525348094369])
f1sm = np.array([94.70069263350196, 28.914212921751343, 16.15635776156504, 10.817221436119258, 7.9182633927410375, 6.115275534907448, 4.895666823205364, 4.022134763086558, 3.370014076784793, 2.867670298039418, 2.4710812663197, 2.1517395068147676, 1.890392306017721, 1.673581442190942, 1.4916251074163858, 1.3373872762019103, 1.2054983624635334, 1.0918453584956742, 0.9932286959029757, 0.9071254984780256, 0.8315226121248848, 0.7647965274653215, 0.7056255118449223, 0.6529243040174799, 0.605794896490979, 0.5634889739201228, 0.5253789201313896, 0.4909352076824915, 0.45970859892953286, 0.43131601416268106, 0.405429222686096, 0.38176572707171563, 0.36008136577414473, 0.34016427263912785, 0.32182991565258207, 0.30491699988274035, 0.2892840667706712, 0.2748066578245177, 0.26137493829837943, 0.24889169770129035, 0.23727066052575663, 0.22643505354206722, 0.21631638621522742, 0.20685340889502637, 0.19799121988090027, 0.1896804976321004, 0.1818768385556322, 0.17454018417139036, 0.16763432418995275, 0.1611264642712924])
f1 = np.array([7.0042677243848575, 4.081136264539721, 2.7023896792095274, 1.9247461634265037, 1.438860602036573, 1.11423554222453, 0.8866915423536676, 0.7212459744765236, 0.597380569760823, 0.5023810568831355, 0.4280226254294146, 0.36879561111335657, 0.3208999722422905, 0.28164874783686483, 0.2491005280107684, 0.2218256839300966, 0.19875354092603878, 0.17907004309196206, 0.1621477574575618, 0.14749708032417938, 0.1347316362805585, 0.12354335746620594, 0.11368427850772263, 0.10495306327726306, 0.09718491343597381, 0.09024392579391699, 0.0840172445332101, 0.07841054386106557, 0.07334450721408689, 0.06875206025290838, 0.06457617925824045, 0.06076814253621544, 0.0572861256594557, 0.054094065601501616, 0.05116073666448909, 0.04845899435489223, 0.04596515329177333, 0.043658472729782766, 0.0415207289831648, 0.03953585840751586, 0.03768965796734641, 0.03596953303491927, 0.034364284110369014, 0.032863925759530344, 0.03145953233512576, 0.03014310605510257, 0.028907463816826913, 0.02774613977153845, 0.026653301203959315, 0.025623675683354566, 0.024652487794956456, 0.023735404040491757, 0.022868484725824676, 0.022048141842504695, 0.021271102105827406, 0.020534374441240892, 0.019835221318329287, 0.01917113342129638, 0.01853980721989225, 0.017939125067732903, 0.01736713750805594, 0.016822047511729235, 0.01630219641033165, 0.015806051319317806, 0.015332193873742973, 0.014879310122443208, 0.014446181446603567, 0.014031676385842658, 0.013634743269717338, 0.013254403565283904, 0.012889745862338363, 0.012539920427484245, 0.012204134266409953, 0.011881646640932067, 0.01157176499359113, 0.011273841238033174, 0.010987268378149688, 0.01071147742312984, 0.010445934569194373, 0.010190138622018355, 0.009943618636637746, 0.009705931754134863, 0.009476661216587863, 0.009255414543691377, 0.009041821856196093, 0.008835534332803315, 0.008636222788529007, 0.008443576363727343, 0.008257301314053701, 0.008077119892574008, 0.007902769316102322, 0.0077340008085848766, 0.007570578715053262, 0.007412279680243265, 0.007258891886561271, 0.007110214346542471, 0.006966056245389477, 0.006826236329597569, 0.006690582337992814, 0.006558930471873793, 0.0064311249012049, 0.006307017304087898, 0.006186466436976888, 0.006069337733316107, 0.005955502928464178, 0.0058448397089653666, 0.005737231384377714, 0.0056325665800097185, 0.00553073894906447, 0.005431646902799062, 0.005335193357425246, 0.005241285496572796, 0.005149834548232661, 0.00506075557517909, 0.004973967277956813, 0.004889391809560088, 0.004806954601043814, 0.004726584197307979, 0.004648212102411606, 0.0045717726337658705, 0.0044972027846387035, 0.004424442094438194, 0.004353432526270939, 0.004284118351304349, 0.004216446039527507, 0.004150364156482356, 0.0040858232656151745, 0.004022775835890725, 0.003961176154354874, 0.0039009802433368976, 0.0038421457820191776, 0.003784632032109304, 0.0037283997673755883, 0.003673411206811328, 0.003619629951220566, 0.0035670209230291424, 0.0035155503091257954, 0.003465185506571298, 0.003415895071004908, 0.0033676486675981096, 0.00332041702441419, 0.0032741718880372746, 0.003228885981348346, 0.0031845329633286667, 0.003141087390781458, 0.003098524681863372, 0.003056821081337289, 0.003015953627444079, 0.002975900120317835, 0.002936639091852584, 0.0028981497769553447, 0.0028604120861043785, 0.0028234065791495158, 0.002787114440290453, 0.0027515174541717295, 0.002716597983042512, 0.002682338944915516, 0.0026487237926912264, 0.002615736494186028, 0.0025833615130276292, 0.0025515837903704575, 0.002520388727393404, 0.0024897621685433602, 0.0024596903854806323, 0.0024301600617053047, 0.0024011582778221234, 0.0023726724974158053, 0.00234469055350867, 0.0023172006355795323, 0.0022901912770995165, 0.0022636513435880484, 0.0022375700211382044, 0.002211936805405332, 0.002186741491039749, 0.0021619741615281477, 0.0021376251794442054, 0.002113685177075856, 0.0020901450474177332, 0.0020669959355168197, 0.002044229230146034, 0.0020218365558013077, 0.001999809764999069, 0.0019781409308701043, 0.001956822340031125, 0.0019358464857206872, 0.001915206061196939, 0.0018948939533734181, 0.0018749032366956755, 0.001855227167238913, 0.0018358591770223135, 0.0018167928685319788, 0.0017980220094372798, 0.0017795405275007233, 0.0017613425056681262, 0.0017434221773365251, 0.0017257739217850546, 0.0017083922597699785, 0.0016912718492739765, 0.0016744074814013287, 0.001657794076419067, 0.0016414266799315194, 0.0016253004591891941, 0.0016094106995218594, 0.0015937528008932156, 0.0015783222745732158, 0.0015631147399227652, 0.0015481259212846339, 0.001533351644978853, 0.001518787836398868, 0.0015044305172029421, 0.0014902758025984062, 0.0014763198987136977, 0.001462559100057767, 0.001448989787059353, 0.0014356084236912536, 0.001422411555163654, 0.0014093958056962963, 0.0013965578763599834, 0.0013838945429876595, 0.0013714026541504355, 0.0013590791291950342, 0.001346920956349325, 0.0013349251908788978, 0.001323088953307109, 0.0013114094276844264, 0.0012998838599172923, 0.0012885095561441006, 0.0012772838811602992, 0.001266204256894187, 0.0012552681609234366, 0.00124447312504633, 0.0012338167338822154, 0.0012232966235262578, 0.0012129104802363173, 0.0012026560391612802, 0.0011925310831059756, 0.0011825334413344607, 0.0011726609884072478, 0.001162911643049381, 0.0011532833670555753, 0.001143774164224891, 0.0011343820793267235, 0.0011251051970941224, 0.00111594164125066, 0.0011068895735591, 0.0010979471929014088, 0.0010891127343827989, 0.0010803844684595862, 0.0010717607000946395, 0.0010632397679348812, 0.0010548200435084062, 0.0010464999304507594, 0.001038277863746184, 0.00103015230898983, 0.0010221217616767, 0.0010141847465009158, 0.0010063398166817298, 0.0009985855533003111, 0.0009909205646646128, 0.0009833434856774798, 0.0009758529772346206, 0.000968447725630927, 0.0009611264419844634, 0.0009538878616759107, 0.0009467307438036867, 0.000939653870650092, 0.0009326560471653555, 0.0009257361004622662, 0.0009188928793251621, 0.0009121252537312824, 0.0009054321143838217, 0.0008988123722577944, 0.0008922649581569391, 0.0008857888222834392, 0.000879382933814249, 0.0008730462804933456, 0.000866777868231922, 0.0008605767207182969, 0.0008544418790357695, 0.0008483724012946301, 0.0008423673622696802, 0.0008364258530481387, 0.0008305469806850563, 0.0008247298678677902, 0.000818973652589762, 0.000813277487830173, 0.0008076405412430059, 0.000802061994852873, 0.0007965410447583784, 0.0007910769008421072, 0.0007856687864892393, 0.0007803159383096864, 0.0007750176058699662, 0.0007697730514308184, 0.0007645815496887916, 0.0007594423875271248, 0.0007543548637697124, 0.0007493182889425912, 0.0007443319850402883, 0.000739395285297915, 0.0007345075339670159, 0.0007296680860993844, 0.00072487630733441, 0.0007201315736899588, 0.0007154332713596701, 0.0007107807965155625, 0.000706173555111732, 0.0007016109626977986, 0.0006970924442314491, 0.0006926174338969569, 0.0006881853749303439, 0.0006837957194429754, 0.0006794479282571236, 0.0006751414707344181, 0.0006708758246184843, 0.0006666504758744642, 0.0006624649185349587, 0.0006583186545490673, 0.0006542111936325241, 0.0006501420531240378, 0.0006461107578447268, 0.000642116839955992, 0.0006381598388273641, 0.0006342393009014585, 0.0006303547795644667, 0.0006265058350206342, 0.000622692034164511, 0.0006189129504625126, 0.0006151681638322553, 0.0006114572605241012, 0.000607779833009798, 0.0006041354798697789, 0.0006005238056817876, 0.000596944420916819, 0.0005933969418306144, 0.0005898809903642502, 0.0005863961940400579, 0.0005829421858657501, 0.0005795186042358778, 0.0005761250928390503, 0.0005727613005638191, 0.000569426881408107, 0.0005661214943899625, 0.0005628448034611944, 0.0005595964774225559, 0.0005563761898378121, 0.0005531836189529084, 0.0005500184476169097, 0.0005468803632018249, 0.0005437690575255339, 0.0005406842267749331, 0.0005376255714355119, 0.0005345927962138238, 0.000531585609970828, 0.0005286037256481256, 0.0005256468602028472, 0.0005227147345367672, 0.0005198070734347347, 0.0005169236054960006, 0.0005140640630739738, 0.000511228182212867, 0.0005084157025861161, 0.0005056263674379024, 0.0005028599235240063, 0.0005001161210535466, 0.0004973947136349329, 0.0004946954582182648, 0.0004920181150415013, 0.0004893624475779588, 0.00048672822248336405, 0.0004841152095457882, 0.0004815231816329161, 0.0004789519146453059, 0.00047640118746742634, 0.00047387078191891426, 0.00047136048270760543, 0.00046887007738677985, 0.0004663993563073012, 0.0004639481125741921, 0.0004615161420029865, 0.0004591032430791867, 0.0004567092169139461, 0.00045433386720441035, 0.00045197700019405744, 0.0004496384246314823, 0.0004473179517327304, 0.0004450153951438527, 0.0004427305709012385, 0.00044046329739816224, 0.0004382133953451136, 0.0004359806877361192, 0.0004337649998155066, 0.00043156615904089393, 0.0004293839950510609, 0.00042721833963182124, 0.0004250690266869984, 0.0004229358922003004, 0.00042081877421117623, 0.0004187175127793514, 0.0004166319499560212])
f1p = np.array([7.005167729388643, 4.08198640428318, 2.7031900393654547, 1.925497232964472, 1.4395636658068844, 1.1148927743786565, 0.8873057996937488, 0.7218204872034306, 0.5979186695839107, 0.5028859884217834, 0.4284974357931065, 0.36924309684903434, 0.3213226632268469, 0.2820489127640009, 0.24948019125221318, 0.22218664745361233, 0.19909740758865768, 0.17939823929463244, 0.1624615541567937, 0.14779761198468994, 0.13501991768203198, 0.12382029845106429, 0.11395069683975949, 0.10520969581233468, 0.09743242580909486, 0.09048292081574177, 0.08424826947095522, 0.0786340967588285, 0.07356104238765082, 0.0689619930756236, 0.06477989033802621, 0.06096598136916239, 0.05747841383294532, 0.0542810996089575, 0.05134279038471109, 0.04863632124109186, 0.04613798830885339, 0.04382703407277005, 0.04168521960500949, 0.039696467380428584, 0.037846561698466084, 0.03612289635421402, 0.03451426124622428, 0.03301066121538763, 0.03160316167875934, 0.030283756630602485, 0.029045255388052846, 0.027881185104685, 0.02678570659592988, 0.0257535414417852, 0.02477990867505606, 0.023860469643198892, 0.022991279861288974, 0.022168746862403648, 0.021389593207647065, 0.02065082394726752, 0.01994969793182693, 0.019283702462037543, 0.018650530840993374, 0.018048062455538007, 0.017474345066609165, 0.016927579033240915, 0.016406103232879807, 0.01590838247290379, 0.015432996215718309, 0.014978628463206935, 0.014544058666402317, 0.014128153543402187, 0.013729859703387139, 0.013348196987295642, 0.012982252446731677, 0.012631174892202291, 0.012294169950018552, 0.011970495574377028, 0.011659457967374304, 0.011360407865144891, 0.01107273715308677, 0.010795875777271199, 0.010529288922812892, 0.010272474433158341, 0.010024960447091766, 0.009786303232714831, 0.009556085199881461, 0.009333913074481663, 0.009119416219691626, 0.008912245090834641, 0.008712069811845613, 0.008518578862517733, 0.008331477866802299, 0.008150488473367138, 0.007975347320479708, 0.0078058050780282, 0.007641625560192891, 0.007482584902871681, 0.007328470800517446, 0.007179081797538474, 0.007034226629846701, 0.0068937236125409095, 0.006757400070072777, 0.006625091805556432, 0.006496642606178305, 0.0063719037819348285, 0.006250733735155687, 0.006132997558480389, 0.0060185666591664935, 0.005907318407777159, 0.005799135809451982, 0.0056939071961253996, 0.005591525938173214, 0.0054918901741027445, 0.005394902557010678, 0.005300470016625588, 0.005208503535851577, 0.005118917940814705, 0.005031631703484851, 0.004946566756021439, 0.004863648316051429, 0.004782804722157904, 0.004703967278890738, 0.004627070110684975, 0.0045520500241034685, 0.004478846377867466, 0.004407400960166546, 0.004337657872807089, 0.004269563421742046, 0.00420306601360316, 0.0041381160578478834, 0.00407466587419111, 0.004012669604980381, 0.003952083132232172, 0.0038928639990326967, 0.00383497133505734, 0.0037783657859507295, 0.0037230094463505657, 0.003668865796338678, 0.003615899641113005, 0.003564077053711811, 0.00351336532059678, 0.0034637328899461716, 0.003415149322497452, 0.0033675852448023964, 0.0033210123047543176, 0.003275403129266315, 0.0032307312839816482, 0.003186971234907105, 0.0031440983118573873, 0.0031020886736249443, 0.0030609192747766663, 0.0030205678339875865, 0.002981012803839744, 0.0029422333420018485, 0.002904209283721434, 0.00286692111555998, 0.0028303499503104573, 0.0027944775030311394, 0.0027592860681466967, 0.0027247584975551345, 0.0026908781796934336, 0.0026576290195209156, 0.002624995419359344, 0.0025929622605637146, 0.002561514885973943, 0.0025306390831117804, 0.0025003210680876824, 0.002470547470182773, 0.0024413053170751955, 0.0024125820206765797, 0.002384365363555388, 0.002356643485913685, 0.0023294048730993534, 0.0023026383436173664, 0.002276333037630283, 0.002250478405914629, 0.0022250641992619604, 0.0022000804582934437, 0.002175517503681582, 0.0021513659267492187, 0.002127616580441187, 0.0021042605706367064, 0.002081289247805183, 0.002058694198975699, 0.002036467240016174, 0.0020146004081995554, 0.0019930859550587555, 0.0019719163394996933, 0.0019510842211776884, 0.0019305824541193946, 0.0019104040805724618, 0.0018905423250921297, 0.0018709905888351812, 0.0018517424440646876, 0.0018327916288525738, 0.001814132041968805, 0.001795757737965037, 0.001777662922415592, 0.0017598419473428765, 0.0017422893067949642, 0.0017249996325802942, 0.0017079676901522376, 0.001691188374632963, 0.0016746567069815387, 0.0016583678302846067, 0.0016423170061821031, 0.0016264996114067915, 0.0016109111344487486, 0.0015955471723277791, 0.00158040342747314, 0.0015654757047097291, 0.0015507599083434678, 0.0015362520393454664, 0.0015219481926221578, 0.001507844554383841, 0.0014939373995903945, 0.0014802230894870388, 0.0014666980692137808, 0.0014533588654960991, 0.0014402020844064831, 0.0014272244092003936, 0.001414422598216694, 0.0014017934828490061, 0.0013893339655753714, 0.001377041018055998, 0.0013649116792844754, 0.001352943053800018, 0.0013411323099525483, 0.001329476678222414, 0.0013179734495927557, 0.0013066199739665608, 0.001295413658638397, 0.0012843519668075322, 0.0012734324161362267, 0.001262652577355204, 0.0012520100729038945, 0.001241502575616777, 0.0012311278074489465, 0.0012208835382300622, 0.0012107675844699626, 0.0012007778081851376, 0.001190912115765801, 0.0011811684568775853, 0.001171544823388775, 0.0011620392483348394, 0.0011526498049067454, 0.0011433746054732572, 0.0011342118006279181, 0.0011251595782624938, 0.001116216162668434, 0.0011073798136643665, 0.0010986488257431952, 0.001090021527248343, 0.001081496279568504, 0.0010730714763588878, 0.0010647455427807615, 0.0010565169347608412, 0.0010483841382738649, 0.0010403456686450302, 0.0010324000698658583, 0.0010245459139372503, 0.0010167818002191043, 0.0010091063548097906, 0.0010015182299308654, 0.0009940161033365489, 0.0009865986777313294, 0.0009792646802121174, 0.0009720128617140966, 0.0009648419964820152, 0.0009577508815465125, 0.0009507383362181271, 0.000943803201594774, 0.0009369443400802532, 0.000930160634916455, 0.0009234509897246036, 0.0009168143280628639, 0.0009102495929923256, 0.0009037557466540296, 0.0008973317698559299, 0.0008909766616717866, 0.0008846894390519964, 0.000878469136437483, 0.0008723148053908523, 0.0008662255142323861, 0.000860200347684429, 0.0008542384065270507, 0.0008483388072612166, 0.0008425006817799092, 0.0008367231770476469, 0.0008310054547855163, 0.0008253466911685982, 0.0008197460765258015, 0.0008142028150494325, 0.0008087161245120554, 0.0008032852359868754, 0.0007979093935807428, 0.000792587854166687, 0.0007873198871279625, 0.0007821047741047349, 0.0007769418087482857, 0.000771830296480965, 0.0007667695542625554, 0.0007617589103583916, 0.0007567977041185526, 0.0007518852857557029, 0.0007470210161348975, 0.0007422042665611483, 0.0007374344185776237, 0.0007327108637664941, 0.0007280330035513138, 0.0007234002490091485, 0.0007188120206831335, 0.0007142677484007835, 0.0007097668710949516, 0.0007053088366316534, 0.0007008931016378755, 0.0006965191313360297, 0.0006921863993830525, 0.0006878943877072739, 0.000683642586357257, 0.0006794304933439671, 0.000675257614499353, 0.000671123463323597, 0.0006670275608465589, 0.0006629694354874327, 0.0006589486229177219, 0.0006549646659282003, 0.0006510171142983039, 0.0006471055246690632, 0.0006432294604155848, 0.0006393884915270674, 0.0006355821944854789, 0.0006318101521497736, 0.0006280719536378811, 0.0006243671942177873, 0.0006206954751955006, 0.0006170564038081148, 0.0006134495931157563, 0.000609874661901956, 0.0006063312345697994, 0.0006028189410427305, 0.0005993374166697865, 0.0005958863021270562, 0.0005924652433280072, 0.0005890738913273731, 0.0005857119022374619, 0.000582378937136027, 0.0005790746619838966, 0.0005757987475354972, 0.0005725508692631313, 0.0005693307072714856, 0.0005661379462201235, 0.0005629722752441991, 0.000559833387881379, 0.0005567209819947661, 0.0005536347597007021, 0.0005505744272961209, 0.0005475396951910037, 0.0005445302778355035, 0.000541545893655277, 0.0005385862649850382, 0.0005356511180014422, 0.0005327401826630676, 0.0005298531926435157, 0.0005269898852738276, 0.0005241500014813477, 0.0005213332857285837, 0.0005185394859587214, 0.0005157683535375866, 0.0005130196431960473, 0.000510293112979072, 0.0005075885241899018, 0.0005049056413377716, 0.0005022442320851849, 0.0004996040672005128, 0.0004969849205045976, 0.0004943865688257883, 0.000491808791948538, 0.0004892513725686564, 0.00048671409624745127, 0.00048419675136409176, 0.0004816991290735189, 0.00047922102326346537, 0.0004767622305074796, 0.0004743225500290441, 0.00047190178365503935, 0.00046949973577852726, 0.0004671162133162065, 0.0004647510256729681, 0.0004624039846991255, 0.00046007490465851784, 0.0004577636021848496, 0.00045546989625067834, 0.00045319360812952174, 0.0004509345613599601, 0.00044869258171417655, 0.0004464674971605035, 0.0004442591378341795, 0.0004420673359998931, 0.00043989192602431255, 0.0004377327443430666, 0.000435589629426613, 0.0004334624217569825])
f1m = np.array([7.003367729381065, 4.080286147252277, 2.7015893587740614, 1.923995154874048, 1.4381576229190158, 1.113578418987007, 0.8860774173534329, 0.7206716157888552, 0.5968426435454014, 0.5018763163040726, 0.4275480212597215, 0.36834834487695484, 0.3204775123529865, 0.28124882411113805, 0.24872111479055622, 0.22146497814249438, 0.19840993876647237, 0.17874211734714682, 0.16183423647373343, 0.1471968290369242, 0.13444363939305945, 0.12326670468878427, 0.11341815168853996, 0.10469672522268532, 0.09693769821598669, 0.09000523033937473, 0.08378652134965517, 0.07818729470398778, 0.07312827759040602, 0.06854243463194302, 0.06437277689205231, 0.06057061380374465, 0.05709414886148326, 0.05390734414424863, 0.05097899657888048, 0.04828198210630408, 0.0457926338417167, 0.04349022781656213, 0.04135655559330154, 0.0393755674137291, 0.0375330729122909, 0.03581648904276477, 0.03421462691076061, 0.03271751081055133, 0.03131622403366398, 0.030002777024561007, 0.02876999426339459, 0.027611416901378413, 0.026521218694624912, 0.025494133203561184, 0.02452539056758221, 0.023610662444256487, 0.022746013931676957, 0.021927861481176356, 0.021152935963448447, 0.02041825018023702, 0.01972107022116345, 0.01905889015485381, 0.01842940961856651, 0.017830513933483658, 0.01726025642586429, 0.01671684267908599, 0.01619861647948169, 0.015704047251158055, 0.015231718802354775, 0.014780319229354164, 0.014348631843955328, 0.013935527007725103, 0.013539954770995715, 0.013160938227313537, 0.01279756750501187, 0.012448994327113994, 0.012114427078989002, 0.011793126330355045, 0.011484400764463956, 0.011187603472717378, 0.010902128577735929, 0.010627408152042888, 0.010362909403172062, 0.010108132099218342, 0.009862606211650502, 0.009625889754703068, 0.00939756680283714, 0.009177245669704745, 0.008964557233774503, 0.008759153397258941, 0.008560705666383246, 0.008368903842183681, 0.008183454812132996, 0.008004081433801576, 0.007830521502651643, 0.007662526796788069, 0.007499862192180821, 0.007342304842492028, 0.007189643418164483, 0.007041677399937216, 0.006898216422380453, 0.006759079663452485, 0.006624095276423212, 0.006493099860840868, 0.006365937969507033, 0.006242461648685398, 0.006122530009012605, 0.006006008824787988, 0.005892770159521709, 0.0057826920157880895, 0.005675658007607398, 0.005571557053707513, 0.005470283090159769, 0.005371734801011448, 0.0052758153656266, 0.005182432221572047, 0.005091496841960049, 0.005002924526249856, 0.00491663420358894, 0.004832548247840553, 0.004750592303512005, 0.004670695121853056, 0.004592788406457143, 0.004516806667734692, 0.004442687085685789, 0.0043703693804318915, 0.004299795690014311, 0.00423091045498749, 0.004163660309394479, 0.004097993977710687, 0.0040338621773876185, 0.003971217526661482, 0.003910014457293353, 0.0038502091319417907, 0.0037917593659023787, 0.0037346245529325823, 0.0036787655949381205, 0.003624144835282384, 0.00357072599550828, 0.0035184741152804594, 0.0034673554953537525, 0.003417337643400664, 0.003368389222533376, 0.0033204800023690913, 0.003273580812493473, 0.0032276634981939605, 0.003182700878330058, 0.003138666705231181, 0.0030955356265071204, 0.0030532831486666393, 0.003011885602451058, 0.0029713201097855383, 0.002931564552271239, 0.002892597541123216, 0.0028543983884955814, 0.0028169470801036635, 0.0027802242490939876, 0.002744211151080478, 0.0027088896403028345, 0.0026742421468386054, 0.0026402516548249748, 0.002606901681629835, 0.0025741762579348975, 0.0025420599086789265, 0.0025105376348224066, 0.0024795948958895924, 0.002449217593255584, 0.002419392054137605, 0.0023901050162613586, 0.002361343613161353, 0.00233309536009972, 0.0023053481405610255, 0.00227809019330045, 0.0022513100999222626, 0.002224996772961053, 0.002199139444445017, 0.002173727654914829, 0.0021487512428806795, 0.0021242003347011515, 0.002100065334852968, 0.0020763369165925313, 0.0020530060129716025, 0.0020300638082051308, 0.002007501729374164, 0.001985311438443203, 0.001963484824582666, 0.0019420139967826712, 0.0019208912767476707, 0.0019001091920521449, 0.0018796604695583898, 0.0018595380290717168, 0.0018397349772369576, 0.00182024460165136, 0.0018010603652017412, 0.001782175900596976, 0.0017635850051083352, 0.001745281635489843, 0.0017272599030893842, 0.001709514069125158, 0.001692038540135318, 0.0016748278635882424, 0.0016578767236413129, 0.0016411799370533713, 0.0016247324492360692, 0.0016085293304430592, 0.001592565772090662, 0.0015768370831989783, 0.0015613386869645814, 0.0015460661174400132, 0.0015310150163287746, 0.0015161811298885397, 0.0015015603059362053, 0.0014871484909545962, 0.0014729417272917723, 0.00145893615045497, 0.0014451279864934454, 0.0014315135494662643, 0.0014180892389893016, 0.0014048515378676891, 0.0013917970097975531, 0.0013789222971470458, 0.0013662241188053868, 0.001353699268099276, 0.001341344610778467, 0.0013291570830612207, 0.0013171336897425307, 0.0013052715023618214, 0.0012935676574265859, 0.0012820193546915386, 0.001270623855489087, 0.0012593784811137955, 0.0012482806112539897, 0.0012373276824720581, 0.0012265171867279297, 0.0012158466699539398, 0.0012053137306622498, 0.001194916018602795, 0.0011846512334560246, 0.0011745171235679889, 0.0011645114847191288, 0.001154632158929002, 0.0011448770333013856, 0.0011352440388973462, 0.001125731149642497, 0.0011163363812666733, 0.0011070577902744848, 0.0010978934729420917, 0.0010888415643479754, 0.0010799002374255132, 0.0010710677020473426, 0.001062342204131097, 0.00105372202477384, 0.0010452054794094345, 0.0010367909169870793, 0.0010284767191770067, 0.0010202612995942528, 0.0010121431030462697, 0.0010041206047995076, 0.000996192309866743, 0.0009883567523144943, 0.0009806124945874195, 0.0009729581268519232, 0.0009653922663591935, 0.0009579135568210207, 0.0009505206678054977, 0.0009432122941508323, 0.00093598715538707, 0.0009288439951810344, 0.0009217815807925132, 0.0009147987025441289, 0.0009078941733060072, 0.0009010668279921415, 0.0008943155230751091, 0.0008876391361049436, 0.0008810365652476962, 0.0008745067288312632, 0.0008680485649069138, 0.0008616610308165337, 0.00085534310277513, 0.0008490937754639373, 0.0008429120616296905, 0.0008367969916989414, 0.000830747613398766, 0.0008247629913874161, 0.0008188422068955805, 0.0008129843573744866, 0.0008071885561541714, 0.0008014539321094827, 0.0007957796293335897, 0.0007901648068223327, 0.0007846086381623129, 0.0007791103112282708, 0.0007736690278877555, 0.0007682840037155303, 0.0007629544677072828, 0.000757679662011504, 0.0007524588416551286, 0.0007472912742855697, 0.000742176239914504, 0.0007371130306682914, 0.0007321009505423649, 0.0007271393151680255, 0.0007222274515743339, 0.0007173646979655141, 0.0007125504034965631, 0.0007077839280583818, 0.000703064642064663, 0.0006983919262451979, 0.0006937651714449319, 0.000689183778426557, 0.0006846471576750835, 0.0006801547292126038, 0.0006757059224106001, 0.0006713001758122234, 0.0006669369369552235, 0.0006626156621999702, 0.0006583358165590126, 0.0006540968735359476, 0.0006498983149620558, 0.0006457396308375852, 0.0006416203191819004, 0.0006375398858796255, 0.0006334978445321022, 0.0006294937163174913, 0.0006255270298457605, 0.0006215973210240916, 0.0006177041329176189, 0.0006138470156216959, 0.0006100255261306042, 0.0006062392282100247, 0.0006024876922761593, 0.0005987704952717353, 0.0005950872205475519, 0.0005914374577500097, 0.000587820802703528, 0.0005842368572989478, 0.0005806852293894723, 0.0005771655326768357, 0.0005736773866149981, 0.0005702204163011831, 0.0005667942523775626, 0.0005633985309355976, 0.0005600328934181548, 0.0005566969865231699, 0.0005533904621166267, 0.000550112977137098, 0.0005468641935115982, 0.0005436437780654409, 0.0005404514024391906, 0.0005372867430040583, 0.0005341494807830614, 0.0005310393013686283, 0.0005279558948446378, 0.0005248989557104508, 0.0005218681828053823, 0.000518863279235166, 0.0005158839522984162, 0.0005129299134184111, 0.000510000878070434, 0.0005070965657166571, 0.0005042166997368046, 0.0005013610073648047, 0.000498529219623441, 0.0004957210712614421, 0.000492936300691677, 0.000490174649931568, 0.0004874358645428338, 0.00048471969357300566, 0.00048202588949916033, 0.00047935420817209364, 0.0004767044087587165, 0.00047407625369177156, 0.00047146950861510963, 0.0004688839423316258, 0.00046631932675252573, 0.00046377543684814266, 0.0004612520505969771, 0.00045874894893939454, 0.0004562659157304339, 0.0004538027376912817, 0.00045135920436695904, 0.0004489351080789017, 0.0004465302438821992, 0.00044414440952238806, 0.00044177740539468486, 0.000439429034499666, 0.00043709910240471685, 0.0004347874172023716, 0.00043249378947442214, 0.0004302180322480355, 0.0004279599609636327, 0.0004257193934334444, 0.0004234961498069453, 0.0004212900525336244, 0.00041910092633019175, 0.0004169285981437896, 0.0004147728971191971, 0.000412633654564924, 0.00041051070391930284, 0.00040840388072212896, 0.0004063130225776432, 0.00040423796912794516, 0.0004021785620199684, 0.000400134644877116])
eps = 1e-3
cv1d = (j1d**2)*((f1p+f1m-(2*f1))/(eps**2))
dif1d = (f1p-f1)/eps
dif1d2 = (f1sp-f1s)/eps
S1d1 = f1-(j1d*dif1d)
S1d2 = f1s-(j1ds*dif1d2)
#2d data
j2d = 1/np.linspace(.1,10,200)
j2ds = 1/np.linspace(.01,1,50)
f2s = np.array([97.77198164474557, 31.248931017367514, 18.14998540204504, 12.58651230938309, 9.520164136777394, 7.583629958036869, 6.252931646041021, 5.284308939462199, 4.549081315740576, 3.972951342567551, 3.5100456198970162, 3.1305230588775013, 2.8141426319256104, 2.546695963786182, 2.317919520680834, 2.1202170282479726, 1.9478477372754108, 1.7963938200044398, 1.6624010501373205, 1.5431304174325988, 1.4363827029233964, 1.3403721976411247, 1.253634233177428, 1.1749564228812972, 1.103326818299752, 1.0378943224457855, 0.9779381113221937, 0.9228437626434952, 0.8720844383382882, 0.8252059169759416, 0.7818145887748005, 0.7415677516066138, 0.7041657093831801, 0.6693452931908667, 0.6368745133585552, 0.6065481162073075, 0.5781838687966506, 0.5516194329989449, 0.5267097198370715, 0.5033246383253848, 0.4813471715378569, 0.4606717270760955, 0.44120272019823537, 0.42285335616212943, 0.4055445841994256, 0.38920419965258735, 0.3737660738429048, 0.3591694935322603, 0.34535859372219985, 0.33228186933653814])
f2sp = np.array([97.77297830956745, 31.24992093238653, 18.150968551697076, 12.5874886776964, 9.521133707350678, 7.584592714017776, 6.2538875701030605, 5.285258013779741, 4.550023521961811, 3.973886661785127, 3.510974032616087, 3.131444544980857, 2.815057170635485, 2.5476035336222895, 2.318820099414085, 2.121110592849232, 1.948734263858506, 1.7972732837626033, 1.6632734252720778, 1.5439956770740966, 1.4372408190411168, 1.341223140943823, 1.2544779730009261, 1.1757929270623801, 1.104156053033756, 1.0387162521246576, 0.978752698348915, 0.9236509672183081, 0.8728842182125526, 0.8259982271715473, 0.7825993812716605, 0.7423449750087832, 0.7049353085860658, 0.6701072090877698, 0.6376286826429568, 0.6072944713443555, 0.5789223382484461, 0.5523499417863034, 0.5274321905017245, 0.5040389923186738, 0.4820533310092671, 0.4613696169806121, 0.44189227059248254, 0.4235345045296118, 0.4062172776437522, 0.38986839681634045, 0.37442174644339055, 0.3598166274510972, 0.3459971896325561, 0.3329119428887734])
f2sm = np.array([97.77098497995708, 31.24794110265362, 18.14900225324488, 12.585535942745432, 9.519194568982718, 7.582667206218916, 6.251975727810098, 5.283359872930275, 4.548139119548486, 3.972016035914529, 3.509117222572836, 3.1296015912975474, 2.8132281151693044, 2.545788419639199, 2.317018971681669, 2.1193234977395163, 1.9469612494622754, 1.795514400016955, 1.6615287241031063, 1.5422652125567604, 1.4355246475784305, 1.339521321467677, 1.2527905671973074, 1.1741199996245082, 1.1024976719479895, 1.037072488995662, 0.977123628772325, 0.9220366712100769, 0.8712847807033476, 0.8244137385703358, 0.7810299380933261, 0.7407906805444846, 0.7033962735709709, 0.6685835522890736, 0.6361205312545086, 0.6058019610399993, 0.5774456127239312, 0.5508891516238089, 0.5259874912290171, 0.5026105416116349, 0.480641285092653, 0.4599741263912432, 0.4405134755673567, 0.4221725303402784, 0.40487223020046337, 0.38854035882726073, 0.3731107743461433, 0.3585227492417061, 0.3447204036228097, 0.33165221734921757])
f2 = np.array([8.54121562693927, 5.354636105998098, 3.7859868005722603, 2.8607205897121624, 2.254867386740801, 1.8301398398762567, 1.5177144209645543, 1.2795469281312102, 1.0929308604829704, 0.9434957610372201, 0.8217159096134897, 0.7210359077256908, 0.6368028734216113, 0.5656274816093598, 0.5049848873286423, 0.45295558187921003, 0.40805152032957565, 0.36909716931435066, 0.33514777588987466, 0.30543321797465867, 0.2793190138272538, 0.25627848469935466, 0.23587210012376839, 0.21773157039528468, 0.2015472446335632, 0.18705794487277225, 0.1740426814998106, 0.16231386709541018, 0.15171174298264267, 0.14209979408189563, 0.1333609713243588, 0.1253945745461422, 0.11811367576626218, 0.1114429847344915, 0.10531707666185082, 0.09967891684309162, 0.09447862899967795, 0.08967246406416486, 0.08522193417405421, 0.0810930831717015, 0.07725587019419657, 0.07368364721618904, 0.07035271487231104, 0.06724194369187171, 0.0643324501551072, 0.06160731883058726, 0.05905136336053876, 0.05665092029132587, 0.05439367075335324, 0.052268485821053035, 0.050265292063485095, 0.048374954356908154, 0.04658917349465339, 0.044900396514378216, 0.043301737982819964, 0.04178691074499928, 0.04035016486796202, 0.03898623369617899, 0.037690286092920244, 0.036457884074406886, 0.03528494515541107, 0.034167708819758516, 0.03310270660960934, 0.03208673539584679, 0.03111683345026698, 0.030190258990160306, 0.029304470908643868, 0.028457111440767773, 0.027645990547034857, 0.02686907182317508, 0.026124459768550507, 0.025410388265921673, 0.02472521014297429, 0.02406738770134046, 0.02343548411222656, 0.022828155589396337, 0.022244144260443972, 0.021682271666208935, 0.021141432825985445, 0.020620590813051485, 0.02011877179105204, 0.01963506046712739, 0.019168595922310988, 0.018718567783921523, 0.01828421270829472, 0.017864811145475896, 0.017459684360369754, 0.017068191687398378, 0.01668972799801442, 0.016323721362434287, 0.0159696308887691, 0.015626944724358657, 0.015295178205553013, 0.014973872143487554, 0.014662591234557513, 0.014360922585333391, 0.014068474342619649, 0.01378487442017301, 0.013509769314370403, 0.013242823001807541, 0.012983715912413513, 0.012732143972231475, 0.012487817710518245, 0.012250461426276922, 0.012019812409744831, 0.011795620214731276, 0.011577645978063378, 0.01136566178265942, 0.011159450061099361, 0.01095880303674189, 0.010763522199743894, 0.010573417815488395, 0.010388308463169817, 0.010208020602431193, 0.010032388166122732, 0.009861252177401717, 0.00969446038952551, 0.009531866946808364, 0.009373332065339697, 0.009218721732152508, 0.009067907421643779, 0.008920765828111401, 0.008777178613383585, 0.00863703216856158, 0.008500217388998399, 0.008366629461658906, 0.008236167664107275, 0.008108735174391776, 0.007984238891158391, 0.007862589263368053, 0.00774370012903993, 0.0076274885624756485, 0.007513874729457105, 0.007402781749945847, 0.007294135567852506, 0.007187864827442789, 0.007083900756021486, 0.006982177052514129, 0.006882629781613309, 0.006785197273185178, 0.006689820026622278, 0.006596440619882307, 0.006505003622942253, 0.0064154555154307845, 0.006327744608202128, 0.006241820968650209, 0.006157636349544902, 0.006075144121213701, 0.005994299206888789, 0.005915058021042251, 0.005837378410566805, 0.005761219598640859, 0.005686542131146493, 0.005613307825505526, 0.0055414797218088395, 0.00547102203612191, 0.0054019001158638535, 0.0053340803971425555, 0.005267530363961071, 0.005202218509192194, 0.005138114297239976, 0.005075188128305992, 0.005013411304176734, 0.004952755995461511, 0.004893195210215974, 0.004834702763872141, 0.0047772532504284804, 0.004720822014826313, 0.004665385126468543, 0.004610919353814367, 0.004557402140017612, 0.0045048115795402665, 0.004453126395711712, 0.004402325919184661, 0.004352390067244622, 0.004303299323940677, 0.004255034720995388, 0.004207577819460961, 0.004160910692087191, 0.004115015906375705, 0.004069876508275233, 0.004025476006515176, 0.003981798357520397, 0.003938827950903799, 0.0038965495955066644, 0.00385494850595277, 0.003814010289712592, 0.0037737209346381394, 0.0037340667969633563, 0.0036950345897376266, 0.0036566113716882285, 0.0036187845364774834, 0.0035815418023566145, 0.0035448712021833493, 0.0035087610737995225, 0.0034732000507506455, 0.0034381770533299955, 0.0034036812799417885, 0.0033697021987650574, 0.003336229539704804])
f2p = np.array([8.542182102087637, 5.355585750515916, 3.7869195033900915, 2.861636231135985, 2.2557658371126514, 1.8310209578798906, 1.518578051433367, 1.2803928991638325, 1.093758979621545, 0.944305810136457, 0.8225076377380175, 0.7218090213624145, 0.637557024935887, 0.5663622620738942, 0.5056998372489644, 0.4536502338451644, 0.40872547198595116, 0.369750162949379, 0.3357797550167173, 0.3060443459911654, 0.2799096586534512, 0.25684918279291774, 0.23642351325806163, 0.21826444409079793, 0.2020623726917692, 0.18755614139832583, 0.17452476005068826, 0.16278062586496367, 0.15216395477053618, 0.14253819991714262, 0.13378627678907484, 0.12580744804239438, 0.11851474814369875, 0.11183284984354935, 0.10569629251443789, 0.10004800715233705, 0.09483808493713938, 0.09002274612173378, 0.08556347405307757, 0.08142628564713429, 0.07758111491963293, 0.0740012904484255, 0.07066309110309545, 0.06754536718084148, 0.06462921636222296, 0.06189770574936433, 0.05933563275528427, 0.05692931884281354, 0.05466643111807676, 0.052535827609541154, 0.05052742274323537, 0.04863207008545778, 0.04684145988808318, 0.045148029356311535, 0.043544883878671094, 0.04202572772592072, 0.0405848029486143, 0.03921683539013072, 0.03791698688919061, 0.03668081287837066, 0.03550422469701304, 0.034383456031741935, 0.03331503297822226, 0.03229574728628202, 0.0313226324088861, 0.03039294202539176, 0.02950413075224794, 0.028653836791052625, 0.027839866295437422, 0.027060179265513934, 0.02631287680214589, 0.025596189573661707, 0.024908467365333677, 0.02424816959725615, 0.02361385670966756, 0.023004182326388015, 0.02241788611725664, 0.02185378728934438, 0.02131077864456094, 0.020787821148112114, 0.020283938958330378, 0.019798214873685153, 0.01932978615750742, 0.018877840705087346, 0.018441613521471133, 0.01802038348155791, 0.017613470346951886, 0.017220232016610933, 0.016840061990617335, 0.01647238702839658, 0.016116664984575153, 0.015772382807239742, 0.015439054684844043, 0.015116220329278467, 0.014803443383817422, 0.014500309945658114, 0.01420642719374419, 0.013921422113382632, 0.013644940309943634, 0.013376644904599675, 0.013116215505688545, 0.012863347249850837, 0.012617749907573503, 0.012379147048259913, 0.01214727526033412, 0.01192188342227997, 0.011702732020844155, 0.01148959251295603, 0.011282246728189919, 0.01108048630884478, 0.010884112184975581, 0.010692934081890157, 0.010506770057848166, 0.010325446069861972, 0.010148795565660229, 0.009976659100034403, 0.009808883973915737, 0.009645323894653387, 0.00948583865608802, 0.009330293837108601, 0.009178560517487305, 0.009030515009865177, 0.008886038606850931, 0.008745017342267285, 0.008607341765645881, 0.008472906729137007, 0.008341611186061668, 0.008213358000382694, 0.008088053766425145, 0.007965608638216246, 0.007845936167872635, 0.007728953152478253, 0.007614579488957332, 0.00750273803646351, 0.007393354485844937, 0.0072863572357717244, 0.007181677275142446, 0.007079248071404044, 0.006979005464453758, 0.006880887565799926, 0.0067848346626921, 0.0066907891269358845, 0.00659869532814062, 0.006508499551145748, 0.006420149917409351, 0.006333596310128478, 0.006248790302904322, 0.006165685091753797, 0.006084235430285773, 0.006004397567890405, 0.005926129190760779, 0.0058493893656170765, 0.005774138485985603, 0.0057003382208978695, 0.005627951465897608, 0.005556942296218565, 0.005487275922044655, 0.005418918645734601, 0.005351837820913666, 0.005286001813345735, 0.005221379963493193, 0.005157942550683, 0.005095660758802121, 0.005034506643442607, 0.004974453100439093, 0.0049154738357129885, 0.0048575433363800945, 0.0048006368430546864, 0.004744730323283702, 0.004689800446074868, 0.004635824557462725, 0.0045827806570535815, 0.004530647375519224, 0.004479403952989873, 0.004429030218302781, 0.004379506569074615, 0.004330813952551866, 0.004282933847214441, 0.004235848245088248, 0.004189539634747428, 0.004143990984967205, 0.004099185728995976, 0.004055107749435142, 0.004011741363682172, 0.0039690713099257815, 0.003927082733663532, 0.0038857611747164884, 0.0038450925547333964, 0.0038050631651468303, 0.0037656596555721016, 0.0037268690226351254, 0.003688678599190669, 0.0036510760439464455, 0.0036140493314469864, 0.003577586742418453, 0.003541676854459276, 0.003506308533053234, 0.003471470922904562, 0.0034371534395736176, 0.003403345761399578])
f2m = np.array([8.540249155163728, 5.3536864690924135, 3.785054111357272, 2.85980496967789, 2.2539689673937913, 1.8292587644443736, 1.5168508466031174, 1.2787010288267324, 1.0921028309019627, 0.9426858216962429, 0.8209243140402404, 0.7202629523289535, 0.6360489091162073, 0.5648929209663884, 0.504270193556635, 0.4522612255362779, 0.40737790560689185, 0.36844455400009857, 0.33451621484264304, 0.30482254489305227, 0.27872885716056084, 0.25570830410702533, 0.23532123002880204, 0.2171992617479616, 0.20103270046851274, 0.18656034831045284, 0.17356121658279539, 0.161847733574496, 0.15126016630669525, 0.14166203173436803, 0.13293631646131546, 0.12498235769513757, 0.11771326516893392, 0.11105378576797298, 0.104938530656684, 0.09931049952550619, 0.09411984871932763, 0.08932285991960322, 0.0848810741130303, 0.08076056211812237, 0.07693130823562795, 0.07336668787301767, 0.07004302346069693, 0.0669392057863584, 0.06403637015241409, 0.06131761861319222, 0.058767781056746196, 0.056373209127298055, 0.05412159799190721, 0.052001831781689885, 0.05000384921802939, 0.048118526495225536, 0.04633757495510224, 0.04465345147391465, 0.04305927980196829, 0.04154878136323886, 0.04011621424537647, 0.038756319297548227, 0.037464272410741524, 0.03623564218760446, 0.035066352320785824, 0.03395264809346701, 0.032891066496199134, 0.031878409522590696, 0.030911720264735237, 0.029988261479155856, 0.029105496336772216, 0.028261071107090207, 0.027452799558363966, 0.026678648882713926, 0.02593672697868051, 0.025225270944047896, 0.02454263664943378, 0.023887289278461725, 0.023257794733699762, 0.022652811819193396, 0.022071085120586278, 0.021511438512739258, 0.020972769232548535, 0.020454042461541953, 0.019954286368837473, 0.019472587570368217, 0.019008086964978684, 0.018559975912098906, 0.018127492719420896, 0.017709919412186623, 0.017306578758636983, 0.016916831528679333, 0.016540073965154327, 0.01617573544906794, 0.015823276342010417, 0.015482185990561632, 0.015151980878949768, 0.014832202917527425, 0.014522417855778345, 0.014222213809614118, 0.013931199893661964, 0.013649004950082382, 0.013375276366215933, 0.013109678974034944, 0.012851894025010706, 0.012601618234538856, 0.012358562890592747, 0.012122453021724567, 0.011893026619928306, 0.011670033914290055, 0.011453236691657327, 0.011242407660888474, 0.011037329857509534, 0.010837796085887265, 0.01064360839622544, 0.010454577593929095, 0.010270522779074103, 0.010091270913880904, 0.009916656416268953, 0.00974652077771158, 0.009580712203740094, 0.009419085275583178, 0.009261500631528495, 0.009107824666707025, 0.008957929250090178, 0.008811691457588738, 0.00866899332020063, 0.008529721586264286, 0.00839376749690519, 0.008261026573861487, 0.008131398418897795, 0.008004786524106003, 0.007881098092412263, 0.007760243867669789, 0.007642137973763101, 0.007526697762171485, 0.007413843667495177, 0.007303499070471172, 0.007195590168032207, 0.007090045850006507, 0.0069867975820724175, 0.006885779294596562, 0.006786927277037788, 0.006690180077584343, 0.006595478407743157, 0.006502765051591948, 0.006411984779447464, 0.006323084265695003, 0.006236012010561398, 0.006150718265604276, 0.006067154962736844, 0.005985275646572986, 0.005905035409938248, 0.005826390832364537, 0.005749299921417906, 0.005673722056710855, 0.005599617936459829, 0.005526949526450613, 0.005455680011299733, 0.005385773747883851, 0.005317196220834685, 0.005249913999990156, 0.005183894699708359, 0.005119106939951886, 0.005055520309046893, 0.004993105328050939, 0.004931833416631208, 0.00487167686039575, 0.004812608779604905, 0.004754603099183318, 0.004697634519993308, 0.004641678491290097, 0.004586711184313268, 0.004532709466960293, 0.004479650879488646, 0.004427513611200119, 0.004376276478067032, 0.004325918901249622, 0.0042764208864681805, 0.004227763004191268, 0.004179926370604369, 0.0041328926293180395, 0.004086643933793665, 0.004041162930445435, 0.003996432742388971, 0.003952436953818102, 0.00390915959497026, 0.0038665851276643622, 0.0038246984313792007, 0.003783484789858943, 0.0037429298782092027, 0.0037030197504763153, 0.0036637408276851153, 0.003625079886308827, 0.0035870240471672617, 0.0035495607647197756, 0.0035126778167524826, 0.003476363294426982, 0.003440605592691536, 0.00340539340103045, 0.003370715694538138, 0.003336561725310355, 0.0033029210141372095, 0.00326978334247917])
cv2d = (j2d**2)*((f2p+f2m-(2*f2))/(eps**2))
cv2ds = (j2ds**2)*((f2sp+f2sm-(2*f2s))/(eps**2))
dif2d = (f2p-f2)/eps
dif2ds = (f2sp-f2s)/eps
S2d1 = f2-(j2d*dif2d)
S2d2 = f2s-(j2ds*dif2ds)

#figure settings
fig , axs = plt.subplots(1,2)
fig.subplots_adjust(wspace=0)

axs[0].set_xticks(np.linspace(0,5,6)[:-1])
axs[0].set_xlim(0,5)
axs[0].set_ylim(0,1)
axs[0].tick_params(axis='x',which='major',size=8,width=1,direction='in',top='on')
axs[0].tick_params(axis='y',which='major',size=8,width=1,direction='in',right='on')
axs[0].set_ylabel(r'$<\vec{s_i} \cdot \vec{s_j}>$'+'   ',fontsize='large')

axs[1].set_xlim(0,5)
axs[1].set_xticks(np.linspace(0,5,6)[:-1])
axs[1].set_ylim(0,1)
axs[1].tick_params(axis='x',which='major',size=8,width=1,direction='in',top=True)
axs[1].tick_params(axis='y',which='major',size=8,width=1,direction='in',right=True,labelleft=False,labelright=True)
axs[1].set_ylabel('Specific Heat C/kN',labelpad=-470,fontsize='large')
plt.gcf().text(0.5,0.04,"Temperature "+r'$\mathtt{J}^{-1}$', ha="center")

#1d
axs[0].scatter(1/j1d,dif1d,linewidth=3,c='mediumblue',label='d=1')
axs[0].scatter(1/j1ds,dif1d2,linewidth=3,c='mediumblue')
#2d
axs[0].scatter(1/j2d,dif2d,linewidth=3,c='firebrick',label='d=2')
axs[0].scatter(1/j2ds,dif2ds,linewidth=3,c='firebrick')


#1d
#axs[1].scatter(1/j1d,cv1d,linewidth=3,c='mediumblue',label='d=1')
#2d
axs[1].scatter(1/j2d,cv2d,linewidth=3,c='firebrick',label='d=2')

axs[1].scatter(1/x_axis,fisher(x_axis),linewidth=3,c='cyan')

axs[0].legend()
axs[1].legend()

plt.show()